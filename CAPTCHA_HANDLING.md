# Обработка CAPTCHA в парсере

## Обзор

Этот документ объясняет, как обрабатывать CAPTCHA-вызовы, которые могут возникнуть при использовании парсера. Сайты электронной коммерции, такие как Wildberries и Ozon, используют меры против ботов для предотвращения автоматизированного скрапинга, которые могут включать CAPTCHA-вызовы.

## Что такое CAPTCHA?

CAPTCHA (Completely Automated Public Turing test to tell Computers and Humans Apart) — это мера безопасности, предназначенная для различения между реальными пользователями и автоматизированными ботами. Обычно требуется решить головоломку или распознать искаженный текст, что сложно для автоматизированных систем.

## Когда вы столкнетесь с CAPTCHA?

Вы можете столкнуться с CAPTCHA-вызовом, когда:

1. Запускаете парсер в первый раз
2. Запускаете парсер несколько раз за короткий период
3. Скрапите большое количество товаров
4. Используете парсер с IP-адреса, который был отмечен за подозрительную активность

## Как парсер обрабатывает CAPTCHA

Парсер теперь включает улучшенное обнаружение и обработку CAPTCHA:

1. **Автоматическое обнаружение**: Парсер может обнаружить, когда появляется CAPTCHA-вызов
2. **Режим ручного вмешательства**: Когда CAPTCHA обнаружена, парсер:
   - Оставит окно браузера открытым
   - Отобразит инструкции в консоли
   - Будет ждать, пока вы вручную решите CAPTCHA
   - Продолжит автоматически после решения CAPTCHA

## Как решить CAPTCHA

Когда появляется CAPTCHA-вызов:

1. Найдите окно браузера, которое должно быть открыто на вашем компьютере
2. Если вы его не видите, проверьте панель задач или диспетчер задач
3. Решите CAPTCHA-головоломку в окне браузера
4. Подождите, пока страница загрузится после решения CAPTCHA
5. Парсер обнаружит, что CAPTCHA решена, и продолжит автоматически

## Тайм-аут

Парсер будет ждать до 5 минут (300 секунд), пока вы решите CAPTCHA. Если CAPTCHA не решена в течение этого времени, парсер прервет операцию.

## Советы по уменьшению CAPTCHA-вызовов

1. **Добавьте задержки**: Используйте парсер реже с более длительными интервалами между запусками
2. **Ограничьте размер партии**: Используйте параметр `--max-items` для ограничения количества товаров, скрапленных за одну сессию
3. **Используйте разные IP-адреса**: Если возможно, используйте разные IP-адреса или VPN-сервис
4. **Имитируйте поведение человека**: Парсер уже реализует некоторые методы для имитации поведения человека, но может потребоваться дополнительная настройка

## Будущие улучшения

Возможные будущие улучшения обработки CAPTCHA могут включать:

1. Интеграцию с сервисами решения CAPTCHA
2. Более сложное маскирование браузера для избежания обнаружения
3. Улучшенную имитацию поведения человека
4. Возможности ротации прокси

## Устранение неполадок

Если вы продолжаете сталкиваться с проблемами с CAPTCHA:

1. Проверьте, действительно ли открывается окно браузера (оно может быть свернуто или в фоновом режиме)
2. Попробуйте запустить парсер с другим поисковым запросом
3. Подождите несколько часов перед повторной попыткой
4. Проверьте, не заблокирован ли ваш IP-адрес сайтом