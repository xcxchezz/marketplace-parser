# Парсер товаров с маркетплейсов Wildberries и Ozon

Данный инструмент позволяет собирать информацию о 100 наиболее популярных товарах на маркетплейсах Wildberries и Ozon в указанной категории, отсортированных по числу заказов или отзывов.

## Собираемые данные

Для каждого товара парсер собирает следующую информацию:

- Название товара
- Категорию
- Бренд
- Цену
- Количество отзывов
- Рейтинг
- Количество фото
- URL всех изображений (в т.ч. инфографики)
- Тексты на изображениях (если есть)
- Ключевые фразы в описании товара
- Содержимое характеристик
- Количество фото с надписями / без
- Цветовая палитра изображения (основные 2–3 цвета)
- Примеры элементов дизайна: иконки, шрифты, композиция

Парсер не собирает информацию о товарах с низким рейтингом (<4.5) или малым числом отзывов (<50).

## Обработка CAPTCHA

Маркетплейсы могут показывать CAPTCHA для предотвращения автоматизированного парсинга. Парсер включает обнаружение и обработку CAPTCHA:

1. При обнаружении CAPTCHA окно браузера останется открытым
2. Вам потребуется вручную решить CAPTCHA в окне браузера
3. Парсер будет ждать до 5 минут, пока вы решите CAPTCHA
4. После решения парсер продолжит работу автоматически

Подробную информацию об обработке CAPTCHA см. в [CAPTCHA_HANDLING.md](CAPTCHA_HANDLING.md).

## Установка

### Требования

- Python 3.7 или выше
- Google Chrome (для Selenium WebDriver)

### Опциональные требования

- Tesseract OCR (для распознавания текста на изображениях)
  - Без Tesseract OCR парсер будет работать, но функция извлечения текста с изображений будет отключена

### Установка зависимостей

1. Клонируйте репозиторий или скачайте исходный код

2. Запустите скрипт установки, который проверит и установит все необходимые зависимости:

```bash
python setup.py
```

Или установите зависимости вручную:

```bash
pip install -r requirements.txt
```

3. (Опционально) Установите Tesseract OCR для распознавания текста на изображениях:

- **Windows**: Скачайте и установите с [официального сайта](https://github.com/UB-Mannheim/tesseract/wiki)
- **macOS**: `brew install tesseract`
- **Linux**: `sudo apt install tesseract-ocr`

4. (Опционально) Установите языковые пакеты для Tesseract (русский язык):

- **Windows**: Скачайте файл `rus.traineddata` и поместите его в папку `tessdata` в директории установки Tesseract
- **macOS/Linux**: `sudo apt install tesseract-ocr-rus` или `brew install tesseract-lang`

## Использование

### Базовое использование

```bash
python main.py [marketplace] [category]
```

Где:
- `[marketplace]` - маркетплейс для парсинга (`wildberries` или `ozon`)
- `[category]` - категория товаров для поиска (например, "сковороды" или "женская одежда")

### Примеры

```bash
# Парсинг товаров категории "сковороды" на Wildberries
python main.py wildberries "сковороды"

# Парсинг товаров категории "женская одежда" на Ozon
python main.py ozon "женская одежда"
```

### Дополнительные параметры

```bash
python main.py [marketplace] [category] --min-rating [rating] --min-reviews [reviews] --max-items [items]
```

Где:
- `--min-rating` - минимальный рейтинг товаров (по умолчанию 4.5)
- `--min-reviews` - минимальное количество отзывов (по умолчанию 50)
- `--max-items` - максимальное количество товаров для сбора (по умолчанию 100)

### Пример с дополнительными параметрами

```bash
# Парсинг 50 товаров категории "сковороды" на Wildberries с рейтингом не менее 4.7 и количеством отзывов не менее 100
python main.py wildberries "сковороды" --min-rating 4.7 --min-reviews 100 --max-items 50
```

## Результаты

Результаты парсинга сохраняются в следующих форматах:

1. **JSON-файл**: Полные данные о всех товарах в формате JSON
2. **CSV-файл**: Основные данные о товарах в табличном формате
3. **Изображения**: Все изображения товаров сохраняются в отдельных папках

Все файлы сохраняются в директории с названием категории в текущей рабочей директории.

## Структура проекта

```
/
├── main.py                  # Основной скрипт запуска
├── wildberries_parser.py    # Парсер для Wildberries
├── ozon_parser.py           # Парсер для Ozon
├── requirements.txt         # Зависимости проекта
└── [category_name]/         # Директория с результатами парсинга
    ├── [product_name]/      # Директория с изображениями товара
    │   ├── image_1.jpg
    │   ├── image_2.jpg
    │   └── ...
    ├── [category]_results.json  # Результаты в формате JSON
    └── [category]_results.csv   # Результаты в формате CSV
```

## Примечания

- Парсер использует Selenium WebDriver для эмуляции браузера, что позволяет обрабатывать динамически загружаемый контент
- Для распознавания текста на изображениях используется Tesseract OCR
- Для анализа цветовой палитры используется ColorThief
- Парсер добавляет случайные задержки между запросами для снижения нагрузки на серверы маркетплейсов

## Ограничения

- Маркетплейсы могут изменять структуру своих страниц, что может привести к некорректной работе парсера
- Некоторые товары могут быть недоступны для парсинга из-за особенностей их представления на сайте
- Распознавание текста на изображениях может работать с ошибками, особенно для декоративных шрифтов или текста на сложном фоне
- Анализ дизайна и композиции изображений является приблизительным

## Предупреждение

Использование данного парсера должно соответствовать правилам использования сайтов Wildberries и Ozon. Чрезмерное количество запросов может привести к временной блокировке вашего IP-адреса. Используйте инструмент ответственно и с разумными ограничениями по частоте запросов.